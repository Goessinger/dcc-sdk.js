const {sign, verify, pack, unpack, signAndPack, unpackAndVerify, signAndPack32, signAndPack45, makeCWT, parseCWT, debug} = require('../lib/index');

test('Verify IT_2DCode_raw_1', async () => {
  const HC1 = 'HC1:6BFOXN%TS3DHZ SYK1.3H-THWOPA.Q/R8WRU2FCAL97I7SDPW%IW/66DIY P8L6IWM$S4U45P84HW6U/4:84LC6 YM::QQHIZC4.OI0QKH:S-B5*CBVZ0K1HK.GORN./G0OP D9G94*LP$V25$0Q:JD4TP:HW1H45PI2IL4TN*4%:K+ 22+40%0E2MR5Q5-CJ6TE6QJQPVD9/-O4ZLPF5RBQ746B46O1N646EN99D9:FR-9C%PD*NI8.A*ESSZ4RZ4E%5B/94O5CZEN MP-E+51%*UMK9JWPFKP+8E9Q5VSP71AP8Q-NP*ZE6WUAA1W81MV1QV10T95CQ5YU T5  PG NO84Q+M.+M*C6*O1JC3HC31835AL5:4A93OOJLWT+EJFG3ZX86HRK7S7QB5CDDKU6O3IX88$RH0BFS7NQN2O9DST*WS$-P8250H7VB4P8I ZC8UHZ2H5VHQQB8Q4KMS34Q*GF-LAEDT--GKKOFNPZ3SQ30%6J05';
  const cwtPayload = await unpackAndVerify(HC1);
  expect(cwtPayload).not.toBe(null);
  expect(cwtPayload).not.toBe(undefined);
  expect(await parseCWT(cwtPayload)).toStrictEqual({'ver': '1.0.0', 'nam': {'fn': 'Di Caprio', 'fnt': 'DI<CAPRIO', 'gn': 'Maril첫 Teresa', 'gnt': 'MARILU<TERESA'}, 'dob': '1977-06-16', 'r': [{'tg': '840539006', 'fr': '2021-05-02', 'co': 'IT', 'is': 'Ministero della Salute', 'df': '2021-05-04', 'du': '2021-10-31', 'ci': '01IT74AB1335AC7D49588B4E0EEFC56471C3#6'}]});
});

test('Verify IT_2DCode_raw_2', async () => {
  const HC1 = 'HC1:6BFOXN%TS3DHZ SYK1.3H-THWOPA.Q/R82JD2FCAL97I7H PW%IW/6TDJY P8L6IWM$S4U45P84HW6U/4:84LC6 YM::QQHIZC4.OI1RM8ZA.A5:S9MKN4NN3F85QNCY0O%0VZ001HOC9JU0D0HT0HB2PL/IB*09B9LW4T*8+DCMH0LDK2%KI*V AQ2%KYZPQV6YP8C12UJ2DI0XM82PCH:6C-2RMAS2D L6*OC3J1IL4Y09VMAXOAIN8-TIK*R3T3+7A.N88J4R$F/MAITHW$P7S3-G9++9-G9+E93ZM$96TV6QRR 1JI7JSTNCA7G6MXYQYYQQKRM64YVQB95326FW4AJOMKMV35U:7-Z7QT499RLHPQ15O+4/Z6E 6U963X7$8Q$HMCP63HU$*GT*Q3-Q4+O7F6E%CN4D74DWZJ$7K+ CZEDB2M$9C1QD7+2F8AVCV3-HL-OQVS:V22AURW48WJD0GFKU2/T%.KRMMR7WF79-DPV185QJ9JU6EPWU5DJPK-G%ZHQODRMUIY9M*NCCS6G3N9P29ROCJHB0TFO62H';
  const cwtPayload = await unpackAndVerify(HC1);
  expect(cwtPayload).not.toBe(null);
  expect(cwtPayload).not.toBe(undefined);
  expect(await parseCWT(cwtPayload)).toStrictEqual({'ver': '1.0.0', 'nam': {'fn': 'Di Caprio', 'fnt': 'DI<CAPRIO', 'gn': 'Maril첫 Teresa', 'gnt': 'MARILU<TERESA'}, 'dob': '1977-06-16', 'v': [{'tg': '840539006', 'vp': '1119349007', 'mp': 'EU/1/20/1528', 'ma': 'ORG-100030215', 'dn': 2, 'sd': 2, 'dt': '2021-04-10', 'co': 'IT', 'is': 'Ministero della Salute', 'ci': '01IT84A0F1A35F1D454C96939812CA55D571#4'}]});
});

test('Verify IT_2DCode_raw_3', async () => {
  const HC1 = 'HC1:6BFZ%EWX7AP2/23OVM179BQHUM2A9AM6JY6V 7V99AW8N*71$0EB.CZG2.432GJN5UR9V7$RB 1NWDY 4RHB1J31+IWCH.*GP33 I3ISQ: GRE21ECRW9X9GXI754BT7TU1SAPSYLM :7Z3DDXBARR2YQV:BHRQAVKFA1WKNA/BF8BXFIBQR-YI8P35EA135*CBEKQ6/P6+I.*MP9MR82D02CBM30BM33%-0/+01JOF D7ZQ:-B:A74JM+D3Y/LXU7I71W7WH-K8-J:9BUPQE:AJXOJ%S7FGMRM$RAX%0 T8O5UF1G6CFMMGLC5AG3LKJ$LREO1KKQJ3QE+K%O2L-525L*.0BM9VW5GV7.TJ%BCSLUY0JXTRO2HP%6:AN/$41VOA*1NFF3NL4J3MHR0J1MDJJYKQGO9$6AIUA4T.2OH757E1LVF:MH0L3TKN2Y5CZFZ7MSMP5-G9M8.Z1WI1RB9H0EPSF6NBQB4GYCULUMH9SU4DWID2AUXTF/0Q3JD%3PV3J/0XPC5ZUGZMEOV.DUSETX5CM8WEN7FUVO.7LAW+ILS.RRXVL-5T0IA-LINQWSDLJV14O99W:3VM1CVV30AVC*DF2R3AVTIQ%WTR:0X%989ACWJ';
  const cwtPayload = await unpackAndVerify(HC1);
  expect(cwtPayload).not.toBe(null);
  expect(cwtPayload).not.toBe(undefined);
  expect(await parseCWT(cwtPayload)).toStrictEqual({'ver': '1.0.0', 'nam': {'fn': 'Di Caprio', 'fnt': 'DI<CAPRIO', 'gn': 'Maril첫 Teresa', 'gnt': 'MARILU<TERESA'}, 'dob': '1977-06-16', 't': [{'tg': '840539006', 'tt': 'LP6464-4', 'nm': 'Roche LightCycler qPCR', 'ma': '1232', 'sc': '2021-05-03T10:27:15Z', 'dr': '2021-05-11T12:27:15Z', 'tr': '260415000', 'tc': 'Policlinico Umberto I', 'co': 'IT', 'is': 'Ministero della Salute', 'ci': '01IT968D16A6C372406C84535B899BA9EE60#1'}]});
});

test('Verify IT_2DCode_raw_4', async () => {
  const HC1 = 'HC1:6BFOXN%TS3DHZ SYK1.3H-THWOPA.Q/R8F0L2FCAL97I7H PW%IW/6TDJY P8L6IWM$S4U45P84HW6U/4:84LC6 YM::QQHIZC4.OI:OIG/Q80P2W4VZ0K1H$$05QN*Y0K.G +AG5T01HJCAMKN$71Z95Z11VTO.L8YBJ-B93:GQBGZHHBIH5C99.B4DBF:F0.8ELG:.CC-8LQECKEBLDSH8XAG.6AFLE*MIJ69$C9YDDO/F .CC*19C4YLV1KK2E9GX8YLVL0K*LP$V25$0Q:JU1J8:IS1LP-8Y2QW%8Q+4%%2P*20-984QW%8A/DJ6TE%2P-8WPPVD9/-O$-V5VA81K0ECM8CXVDC8C90JZJAPEDI.C$JC7KDF9C$ZJ*DJ3Q4+Y5MT4I0PA6PL96LHPE:72W58VQLQA9D75BKOL6SA7G6M+CR9D6AVQ+ Q9 O/DP+ERR95:16$17V35LETV-9-DIEQK2US8%SD441DLNCKUCI5OI9YI:8DT:D%PDX1L67D-NSCTKU%4KLEYWCNSPRQAO1AK35Y/J/QVRQ9JYAI/68*DAQV:-TMLOIRED9UGJIWR5QMIUO7EURZ5UM/A2*H-WNI.BICJO*VYRS7.5PFUO40T$0K3';
  const cwtPayload = await unpackAndVerify(HC1);
  expect(cwtPayload).not.toBe(null);
  expect(cwtPayload).not.toBe(undefined);
  expect(await parseCWT(cwtPayload)).toStrictEqual({'ver': '1.0.0', 'nam': {'fn': 'Di Caprio', 'fnt': 'DI<CAPRIO', 'gn': 'Maril첫 Teresa', 'gnt': 'MARILU<TERESA'}, 'dob': '1977-06-16', 't': [{'tg': '840539006', 'tt': 'LP6464-4', 'nm': 'Roche LightCycler qPCR', 'ma': '', 'sc': '2021-05-10T10:27:15Z', 'dr': '2021-05-11T12:27:15Z', 'tr': '260415000', 'tc': 'Policlinico Umberto I', 'co': 'IT', 'is': 'Ministero della Salute', 'ci': '01IT99945629C428438583B6C628FF718A29#2'}]});
});

