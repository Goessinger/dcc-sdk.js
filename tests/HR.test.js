const {sign, verify, pack, unpack, signAndPack, unpackAndVerify, signAndPack32, signAndPack45, makeCWT, parseCWT, debug} = require('../lib/index');

test('Verify HR_2DCode_raw_1', async () => {
  const HC1 = 'HC1:NCFOXNEG2NBJ5*H:QOY0P*WETNRNFWNAQU 2HWFH PW%I: 6WX6S+GX3E1.BLEELEACI8:NJC19BJCCD9W0I1QE:/FPC9JMKNO4*J8OX4UZ85XPWLICN5YO9OUUMK9WLIK*L5R1AT7B LPRKE64JIRWP4UA7BJPL35MV4DYPWGO*88+EQXCRXQ65*K7 OA$QY76UW6H+9NM5IUPH233ZC0/2LKB5VA81K0ECM8CXVDC8C 1J5OILR0/DC*107 17LPMIH-O92UQNRMDVB-%VK37OLN2*8 /KZ%K$E78*3.+T ZJ83BK91B7EBFH8ALD-I9C0A:V4PIQJAZGA2:UG%U2E4MG7F7IK3IQZE9XLV/Q0Q9G IYV6 :H4:D3$9U2C+04X9K6TFZ TGV84$8XSMB:EE26.CFBNO5/7QTV*WSDDV+9LY+9N2CPL5U N::T:407MRB5';
  const cwtPayload = await unpackAndVerify(HC1);
  expect(cwtPayload).not.toBe(null);
  expect(cwtPayload).not.toBe(undefined);
  expect(await parseCWT(cwtPayload)).toStrictEqual({'r': [{'ci': 'urn:uvci:01:HR:MZ0000000314', 'co': 'HR', 'df': '2020-12-15', 'du': '2021-06-13', 'fr': '2020-12-01', 'is': 'Ministry of Health', 'tg': '840539006'}], 'dob': '2000-01-01', 'nam': {'fn': 'FERNÁNDEZ', 'gn': 'RAMÓN', 'fnt': 'FERNANDEZ', 'gnt': 'RAMON'}, 'ver': '1.0.0'});
});

test('Verify HR_2DCode_raw_2', async () => {
  const HC1 = 'HC1:NCFOXNEG2NBJ5*H:QOY0P*WETNRNFWNAQU 2 G6O:5-RIAAJ 3NLX8UJM$KP92PA4IAN9I6T5XH3E2%E30$4*2D/79B+2SEB7:I/2DY73VJBXO04NVT835CGRJN1JAM*7.$FZH9C+GYHILIIX2MBIHAHIPBHFEG*336J37A0N$KKQS7DS2*N.SSBNKA.G.P6A8IM%OVNI0%KTVCVKFOLI:R2K$FS0W.8IIAF8F55RV368Z5QO.FC:HFD1.0K 4MK:HUZ4+FJE 4Y3LL/II 05B9.Z8M+8:Y001H%Y050WR83/70K%4E+4T+4ZD5CC9T0HR0J5QNR88WYH WUQRELS4J1TD*G9Q7*47O05HBTW77P40TTE-PEB/9MM5YC18ALG%IO*OQJAZGA2:UG%U2E4DVCI6EG:9 C5 C7%9LPGCS8VC-JUZU3:EJWB*JAD3UF/TDFHMR9A5BL8SSAN1AEQ.J9YIP191J7X4GDK2I95G:NW9DDCAPDJ26TQVM+30:56C1';
  const cwtPayload = await unpackAndVerify(HC1);
  expect(cwtPayload).not.toBe(null);
  expect(cwtPayload).not.toBe(undefined);
  expect(await parseCWT(cwtPayload)).toStrictEqual({'t': [{'ci': 'urn:uvci:01:HR:MZ0000000371', 'co': 'HR', 'dr': '2021-04-25T00:00:00+02:00', 'is': 'Ministry of Health', 'sc': '2021-04-25T00:00:00+02:00', 'tc': 'KLINIČKI BOLNIČKI CENTAR RIJEKA', 'tg': '840539006', 'tr': '260415000', 'tt': 'LP6464-4'}], 'dob': '1996-11-03', 'nam': {'fn': 'TKALAC', 'gn': 'ADRIJANA', 'fnt': 'TKALAC', 'gnt': 'ADRIJANA'}, 'ver': '1.0.0'});
});

test('Verify HR_2DCode_raw_3', async () => {
  const HC1 = 'HC1:NCFOXNEG2NBJ5*H:QOY0P*WETNRNFWNAQU 28G67ABM*4B465.E7QCL MG.CZ.C4C96+KA0G6LG9KDG+9L0H5MGRDA6JC*/CCV4*XUA2PSGH% 9$NI4L6TYK6VH6ZL4XP:N6ON1N+LHNG2YF:N13HOHDON95*280K4395R4I-B5ET42HPPEPHCRIABFDOAC5.BNBXQ*$K3$OHBW24F3P82-C%P8*$K8KG+9RR$F+ F%J00N89M40%KLR2A KZ*U0I1-I0*OC6H0/VMNPM/UESJ0A5LCJ0RUSQQOBAEBIHZEG%X12OI5OI9YI:8D1:C%PDCO07LPMIH-O92UQNE6RLGSSK8%FNJG14A-L96DEXZ1Y46B/9BL536HQ05KCT$ZK9YGUVPQRHIY1VS11O1YT3H/QM.TG1VZF9$QO05EOBQG17KNFJBR:5LRD88MV9WNBESL19Y%4U-AYYBGVE8P56%9GGD$3I26M*9U0/Q8HVP4IX6U65CHOM.JQIC25LK%GL';
  const cwtPayload = await unpackAndVerify(HC1);
  expect(cwtPayload).not.toBe(null);
  expect(cwtPayload).not.toBe(undefined);
  expect(await parseCWT(cwtPayload)).toStrictEqual({'v': [{'ci': 'urn:uvci:01:HR:MZ0000000309', 'co': 'HR', 'dn': 1, 'dt': '2021-03-01', 'is': 'Ministry of Health', 'ma': 'ORG-100030215', 'mp': 'EU/1/20/1528', 'sd': 2, 'tg': '840539006', 'vp': 'J07BX03'}, {'ci': 'urn:uvci:01:HR:MZ0000000309', 'co': 'HR', 'dn': 2, 'dt': '2021-04-05', 'is': 'Ministry of Health', 'ma': 'ORG-100030215', 'mp': 'EU/1/20/1528', 'sd': 2, 'tg': '840539006', 'vp': 'J07BX03'}], 'dob': '1969-02-02', 'nam': {'fn': 'PREZIME01', 'gn': 'TEST01', 'fnt': 'PREZIME', 'gnt': 'TEST'}, 'ver': '1.0.0'});
});

test('Verify HR_2DCode_raw_4', async () => {
  const HC1 = 'HC1:NCFOXNEG2NBJ5*H:QOY0P*WETNRNFWNAQU 26I67X5-RIAAJP:CXG40IR-$OAD6PN4 NI4EFSYSC%O66PYE9*FJFSQAZ8-.A2*CEHJ5$0-*AVB8V2OMY0O8C0:DJZI9.1$7KGIA3A41VCSWC%PD:NKBTCTJCB6C3/8VZ0958AC59GN1:6G16IFNPCL694F$9DK4LC6QP4L956D6XHQ1EPD95O7N5SOYVQB87Z8QYJ8+KRA+PE$85FQ2JOG%BM95F77647$8K/Y4EU2/DALHC- 5/DA:D1::HK2GVD16%5::HVIOLHCOH12KOK1MANF+1WZ%J*PGL3WYNGOYB53IBT1QCE$$U-G9+E93ZM$96PZ6+Q6X46%E5EPPQF67460R6P00PEB8/SG8C49D:8DDIK.ZJ5OI9YI:8D4:CWND$T87LPMIH-O92UQ*SQX FRQGN7I7Y4HBTNIV-IF.8FMSV+*431T%ZK9:O/UI2YU262F%CD 810H% 0NY04%1M%U-NF+QEX-1T6GW.UN0VEM9PEWMWLM.TGCW9/HQV2JID:KMCDRPPDY1V WV3PVKFJ2K9%08V7DNHQ2EPUM44 U15C 5K094GWU950917J1';
  const cwtPayload = await unpackAndVerify(HC1);
  expect(cwtPayload).not.toBe(null);
  expect(cwtPayload).not.toBe(undefined);
  expect(await parseCWT(cwtPayload)).toStrictEqual({'t': [{'ci': 'urn:uvci:01:HR:MZ0000000378', 'co': 'HR', 'dr': '2021-04-20T00:00:00+02:00', 'is': 'Ministry of Health', 'ma': '1223', 'nm': 'BIOSYNEX COVID-19 Ag BSS', 'sc': '2021-04-20T00:00:00+02:00', 'tc': 'ZAVOD ZA JAVNO ZDRAVSTVO OSJEČKO-BARANJSKE ŽUPANIJ', 'tg': '840539006', 'tr': '260415000', 'tt': 'LP217198-3'}], 'dob': '1963-03-01', 'nam': {'fn': 'KLASIĆ', 'gn': 'LJILJANA', 'fnt': 'KLASIC', 'gnt': 'LJILJANA'}, 'ver': '1.0.0'});
});

